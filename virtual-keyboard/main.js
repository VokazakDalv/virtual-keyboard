(()=>{"use strict";const e=class{constructor(e,t="div",n="",s=""){this.node=document.createElement(t),this.node.className=n,this.node.textContent=s,e&&e.append(this.node)}destroy(){this.node.remove()}},t=["`","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","q","w","e","r","t","y","u","i","o","p","[","]","\\","Del","CapsLock","a","s","d","f","g","h","j","k","l",";","'","Enter","Shift","z","x","c","v","b","n","m",",",".","/","▲","Shift","Crtl","Win","Alt"," ","Alt","◄","▼","►","Crtl"],n=["ё","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","й","ц","у","к","е","н","г","ш","щ","з","х","ъ","\\","Del","CapsLock","ф","ы","в","а","п","р","о","л","д","ж","э","Enter","Shift","я","ч","с","м","и","т","ь","б","ю",".","▲","Shift","Crtl","Win","Alt"," ","Alt","◄","▼","►","Crtl"],s=["`","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","q","w","e","r","t","y","u","i","o","p","[","]","\\","Delete","CapsLock","a","s","d","f","g","h","j","k","l",";","'","Enter","Shift","z","x","c","v","b","n","m",",",".","/","ArrowUp","Shift","Control","Win","Alt"," ","Alt","ArrowLeft","ArrowDown","ArrowRight","Control"],i=["Backspace","Tab","Enter","Shift","Control","Win","Alt","CapsLock","Delete"],o=["ArrowRight","ArrowLeft","ArrowDown","ArrowUp"];new class{constructor(){let a=[];a=localStorage.getItem("chizhikov-LG")?[...n]:[...t],this.collectionKey=[],this.collectionSpan=[],this.lang="EN",this.form=new e(document.body,"form"),this.textArea=new e(this.form.node,"textarea"),this.container=new e(document.body,"div","container"),a.forEach(((t,n)=>{this.key=new class{constructor(t,n,s="",i="",o=""){this.currentTextArea=o,this.span=new e(t,"span"),this.span.node.dataset.key=n,this.span.node.addEventListener("mousedown",this.mouseDownHandle.bind(this)),this.span.node.addEventListener("mouseup",(()=>{this.span.node.classList.remove("span-click")})),"Backspace"!==i&&"Enter"!==i&&"Shift"!==i&&"CapsLock"!==i||this.span.node.classList.add("big")," "===i&&this.span.node.classList.add("space"),"Crtl"===i&&this.span.node.classList.add("ctrl"),this.iUp=new e(this.span.node,"i","up",s),this.iDown=new e(this.span.node,"i","down",i)}mouseDownHandle(e){const t=this.span.node.dataset.key;e.preventDefault(),this.currentTextArea.node.focus(),this.keyPrint(),this.span.node.addEventListener("mouseout",(()=>{this.span.node.classList.remove("span-click")})),this.span.node.classList.add("span-click"),"CapsLock"===t?this.span.node.classList.toggle("span-active"):this.specialKeysHandle(t)}keyPrint(){const[e]=[this.currentTextArea.node],t=e.selectionStart,n=e.selectionEnd;if(i.indexOf(this.span.node.dataset.key)<0){const s=e.selectionStart;e.value=e.value.substring(0,t)+this.iDown.node.innerText+e.value.substring(n),e.selectionEnd=s+1}}specialKeysHandle(e){const[t]=[this.currentTextArea.node],n=t.selectionStart,s=t.selectionEnd,i=t.selectionStart;switch(e){case" ":t.value=`${t.value.substring(0,n)} ${t.value.substring(n)}`,t.selectionEnd=i+1;break;case"Delete":t.value=t.value.substring(0,n)+t.value.substring(n+1),t.selectionEnd=i;break;case"Backspace":t.value=t.value.substring(0,n-1)+t.value.substring(s),t.selectionEnd=i-1;break;case"Enter":t.value=`${t.value.substring(0,n)}\n${t.value.substring(s)}`,t.selectionEnd=i+1;break;case"Tab":t.value=`${t.value.substring(0,n)}\t${t.value.substring(s)}`,t.selectionEnd=i+1}}}(this.container.node,s[n],"",t,this.textArea),this.collectionKey.push(this.key.iDown),this.collectionSpan.push(this.key.span),"CapsLock"===this.key.iDown.node.innerText&&this.key.span.node.addEventListener("click",this.changeLetterCase.bind(this))})),document.addEventListener("keydown",(e=>{if(this.textArea.node.focus(),n.indexOf(e.key)>=0||t.indexOf(e.key)>=0){if(e.preventDefault(),o.indexOf(e.key)<0&&i.indexOf(e.key)<0){const t=this.collectionSpan.find((t=>t.node.dataset.key===e.key.toLowerCase()));t.node.classList.add("span-click"),this.keyPrint(this.textArea.node.selectionStart,this.textArea.node.selectionEnd,t.node.children[1].innerHTML)}else this.specialKeysHandle(e);"Tab"===e.key&&this.key.tabHandle(),"CapsLock"===e.key&&(this.collectionSpan[29].node.classList.toggle("span-active"),this.changeLetterCase()),o.indexOf(e.key)>=0&&this.key.keyPrint(this.textArea.node.selectionStart,this.textArea.node.selectionEnd)}})),document.addEventListener("keyup",(e=>{o.indexOf(e.key)<0&&i.indexOf(e.key)<0?this.collectionSpan.find((t=>t.node.dataset.key===e.key.toLowerCase())).node.classList.remove("span-click"):this.specialKeysHandle(e)})),this.runOnKeys((()=>{this.changeLang()}),"AltLeft","ControlLeft")}specialKeysHandle(e){if(!e.repeat){const t=this.collectionSpan.find((t=>t.node.dataset.key===e.key));"Shift"!==e.key&&"Control"!==e.key&&"Alt"!==e.key&&t.node.classList.toggle("span-click"),"Shift"===e.key&&("ShiftLeft"===e.code?t.node.classList.toggle("span-click"):this.collectionSpan[54].node.classList.toggle("span-click")),"Control"===e.key&&("ControlLeft"===e.code?t.node.classList.toggle("span-click"):this.collectionSpan[63].node.classList.toggle("span-click")),"Alt"===e.key&&("AltLeft"===e.code?t.node.classList.toggle("span-click"):this.collectionSpan[59].node.classList.toggle("span-click"))}}keyPrint(e,t,n){const s=this.textArea.node.selectionStart;this.textArea.node.value=this.textArea.node.value.substring(0,e)+n+this.textArea.node.value.substring(t),this.textArea.node.selectionEnd=s+1}changeLang(){let e=[...n];"EN"===this.lang?this.lang="RU":(this.lang="EN",e=[...t]),this.collectionKey.forEach(((t,n)=>{t.node.innerText=e[n]}))}runOnKeys(e,...t){let n="";n=this.lang,this.lang=n;const s=[];document.addEventListener("keydown",(e=>{e.repeat||s.push(e.code)})),document.addEventListener("keyup",(()=>{if(0===s.length)return;let n=!0;t.forEach((e=>{s.includes(e)||(n=!1)})),n&&e(),s.length=0}))}changeLetterCase(){const e=this.collectionKey[15].node.innerText;this.collectionSpan.forEach(((t,n)=>{i.indexOf(t.node.dataset.key)<0&&(e.toUpperCase()!==e?this.collectionKey[n].node.innerText=this.collectionKey[n].node.innerText.toUpperCase():this.collectionKey[n].node.innerText=this.collectionKey[n].node.innerText.toLowerCase())}))}}})();